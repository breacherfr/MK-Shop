<!DOCTYPE html>
<html lang="fr" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MK SHOP - V18 PRO</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;700;900&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: { sans: ['Montserrat', 'sans-serif'] },
                    colors: {
                        mk: { bg: '#0f172a', card: '#1e293b', accent: '#06b6d4' }
                    }
                }
            }
        }
    </script>
    <style>
        .glass { background: rgba(30, 41, 59, 0.7); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.05); }
        .dark-mode-transition { transition: background-color 0.3s, color 0.3s; }
        .video-container { position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; }
        .video-container iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: 0; }
    </style>
</head>
<body class="bg-slate-100 dark:bg-mk-bg text-slate-900 dark:text-white min-h-screen font-sans dark-mode-transition">

    <nav class="glass sticky top-0 z-50 px-4 py-3 flex justify-between items-center border-b border-white/10">
        <div class="flex items-center gap-2 cursor-pointer" onclick="location.reload()">
            <span class="text-2xl">üõçÔ∏è</span>
            <h1 class="text-xl font-black italic uppercase tracking-tighter">MK <span class="text-mk-accent">SHOP</span></h1>
        </div>

        <div class="flex items-center gap-3">
            <button onclick="toggleTheme()" class="p-2 bg-slate-200 dark:bg-slate-800 rounded-lg text-sm">üåì</button>
            
            <button id="nav-tv-btn" onclick="openTvSection()" class="hidden bg-red-600 hover:bg-red-500 text-white text-[10px] font-bold px-3 py-2 rounded-lg animate-bounce">üì∫ ACC√àS TV</button>

            <div id="user-display" class="hidden text-xs font-bold border border-mk-accent px-3 py-1 rounded-full text-mk-accent"></div>
            
            <div id="auth-btns" class="flex gap-2">
                <button onclick="openModal('auth-modal')" class="text-xs font-bold px-3">CONNEXION</button>
                <button onclick="openModal('auth-modal')" class="bg-mk-accent text-white text-xs font-bold px-4 py-2 rounded-lg">JOIN</button>
            </div>
            <button onclick="openAdminAuth()" class="text-[8px] opacity-20 hover:opacity-100">ADMIN</button>
        </div>
    </nav>

    <main id="shop-view" class="max-w-7xl mx-auto p-6">
        <div class="text-center my-12">
            <h2 class="text-5xl font-black italic mb-2">MK MARKET <span class="text-mk-accent">V18</span></h2>
            <p class="text-gray-500 text-sm uppercase tracking-widest">Premium Digital Assets & Entertainment</p>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
            <div class="glass p-6 rounded-3xl border-2 border-mk-accent/30 relative">
                <span class="absolute -top-3 left-6 bg-mk-accent text-black text-[10px] font-black px-3 py-1 rounded-full">BEST SELLER</span>
                <div class="text-4xl mb-4">üéÆ</div>
                <h3 class="text-xl font-bold mb-1">Comptes Roblox</h3>
                <p class="text-xs text-gray-400 mb-4">VERIFIED & LOADED</p>
                <ul class="text-sm space-y-2 mb-6 opacity-80">
                    <li>‚Ä¢ Robux : 0 √† 1000 garantis</li>
                    <li>‚Ä¢ V√©rification d'√¢ge (+13) active</li>
                    <li>‚Ä¢ Full Max (Blox Fruit/Da Hood)</li>
                </ul>
                <div class="flex justify-between items-center">
                    <span class="text-xl font-black">10.00‚Ç¨</span>
                    <button onclick="startChat('Compte Roblox')" class="bg-white text-black px-5 py-2 rounded-xl font-bold hover:bg-mk-accent transition">ACHETER</button>
                </div>
            </div>

            <div class="glass p-6 rounded-3xl">
                <div class="text-4xl mb-4">üì∫</div>
                <h3 class="text-xl font-bold mb-1">Pack TV & Anim√©s</h3>
                <p class="text-xs text-gray-400 mb-4">IPTV & EXCLUSIVIT√âS</p>
                <ul class="text-sm space-y-2 mb-6 opacity-80">
                    <li>‚Ä¢ Cha√Ænes Fran√ßaises (TF1, M6, BFM...)</li>
                    <li>‚Ä¢ Dessins Anim√©s & Films (Netflix/Disney+)</li>
                    <li>‚Ä¢ Acc√®s illimit√© via MK TV</li>
                </ul>
                <div class="flex justify-between items-center">
                    <span class="text-xl font-black">4.99‚Ç¨</span>
                    <button onclick="startChat('Abonnement TV')" class="bg-white text-black px-5 py-2 rounded-xl font-bold hover:bg-mk-accent transition">ACHETER</button>
                </div>
            </div>

            <div class="glass p-6 rounded-3xl bg-gradient-to-br from-purple-900/20 to-transparent">
                <div class="text-4xl mb-4">‚ú®</div>
                <h3 class="text-xl font-bold mb-1">Demande Perso</h3>
                <p class="text-xs text-gray-400 mb-4">SUR MESURE</p>
                <p class="text-xs opacity-70 mb-6">Besoin d'un truc sp√©cifique ? Un cheat, un compte rare ou un film pr√©cis ?</p>
                <button onclick="startChat('Demande Personnalis√©e')" class="w-full bg-purple-600 text-white py-3 rounded-xl font-bold">CONTACTER</button>
            </div>
        </div>
    </main>

    <div id="tv-view" class="hidden fixed inset-0 z-[60] bg-black overflow-y-auto p-4 lg:p-10">
        <div class="flex justify-between items-center mb-10">
            <h2 class="text-3xl font-black text-mk-accent">MK <span class="text-white">STREAMING</span></h2>
            <button onclick="closeTvSection()" class="bg-white/10 px-4 py-2 rounded-lg">Retour Boutique</button>
        </div>

        <div id="tv-unlock" class="max-w-md mx-auto text-center py-20">
            <h3 class="text-xl mb-4">Entrez votre code d'acc√®s MK TV</h3>
            <input id="tv-password" type="text" placeholder="ACCES-ACHETER-XXXX" class="w-full bg-slate-900 border border-white/20 p-4 rounded-xl mb-4 text-center">
            <button onclick="unlockTv()" class="bg-mk-accent text-black font-bold px-10 py-3 rounded-xl">DEVEROUILLER</button>
        </div>

        <div id="tv-content" class="hidden">
            <div class="grid grid-cols-1 lg:grid-cols-4 gap-6">
                <div class="lg:col-span-3">
                    <div id="player-wrapper" class="aspect-video bg-slate-900 rounded-3xl overflow-hidden border border-white/10 shadow-2xl relative">
                        <div id="player-placeholder" class="absolute inset-0 flex items-center justify-center text-gray-500">
                            S√©lectionnez un programme pour commencer
                        </div>
                        <div id="yt-player-container" class="hidden w-full h-full">
                            <iframe id="yt-iframe" src="" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen class="w-full h-full"></iframe>
                        </div>
                        <video id="hls-player" class="hidden w-full h-full" controls></video>
                    </div>
                    <h3 id="current-title" class="text-2xl font-bold mt-4 text-mk-accent">---</h3>
                </div>
                
                <div class="space-y-4">
                    <div class="bg-slate-900/50 p-4 rounded-2xl border border-white/5 h-[600px] overflow-y-auto">
                        <p class="text-[10px] font-bold text-gray-500 uppercase mb-4">Cha√Ænes & Films</p>
                        <div id="playlist-items" class="space-y-2">
                            </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="auth-modal" class="hidden fixed inset-0 z-[100] bg-black/80 backdrop-blur flex items-center justify-center p-4">
        <div class="bg-slate-900 p-8 rounded-3xl w-full max-w-sm border border-white/10">
            <h3 class="text-2xl font-bold mb-6 text-center">Rejoindre MK</h3>
            <input id="in-user" type="text" placeholder="Pseudo" class="w-full bg-black border border-white/10 p-3 rounded-xl mb-3">
            <input id="in-pass" type="password" placeholder="Mot de passe" class="w-full bg-black border border-white/10 p-3 rounded-xl mb-6">
            <button onclick="handleAuth()" class="w-full bg-mk-accent text-black font-bold py-3 rounded-xl">VALIDER</button>
            <button onclick="closeModal('auth-modal')" class="w-full mt-2 text-xs opacity-50">Fermer</button>
        </div>
    </div>

    <div id="chat-modal" class="hidden fixed inset-0 z-[100] bg-black/80 flex items-center justify-center p-4">
        <div class="bg-slate-900 w-full max-w-md h-[550px] rounded-3xl overflow-hidden flex flex-col border border-white/10">
            <div class="bg-mk-accent p-4 text-black font-bold flex justify-between">
                <span id="chat-target">Vendeur MK</span>
                <button onclick="closeModal('chat-modal')">‚úï</button>
            </div>
            <div id="chat-body" class="flex-1 p-4 overflow-y-auto space-y-4 bg-black/20"></div>
            <div class="p-4 bg-slate-800 flex gap-2">
                <input id="chat-input" type="text" placeholder="Ecrire..." class="flex-1 bg-black rounded-full px-4 text-sm outline-none">
                <button onclick="sendMsg()" class="bg-mk-accent text-black w-10 h-10 rounded-full flex items-center justify-center font-bold">‚û§</button>
            </div>
        </div>
    </div>

    <div id="admin-modal" class="hidden fixed inset-0 z-[200] bg-black p-6 overflow-y-auto">
        <div class="max-w-5xl mx-auto">
            <div class="flex justify-between items-center border-b border-white/10 pb-4 mb-6">
                <h2 class="text-green-500 font-mono text-xl">MK_CONTROL_CENTER</h2>
                <button onclick="closeModal('admin-modal')" class="text-red-500">EXIT</button>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="bg-slate-900 p-4 rounded-xl">
                    <h3 class="text-xs font-bold mb-4 opacity-50">COMPTES CLIENTS</h3>
                    <div id="admin-user-list" class="space-y-2"></div>
                </div>
                <div class="bg-slate-900 p-4 rounded-xl">
                    <h3 class="text-xs font-bold mb-4 opacity-50">MESSAGES INTERCEPT√âS</h3>
                    <div id="admin-chat-logs" class="space-y-2"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const TV_CODE = "ACCES-ACHETER-0001";
        const ADMIN_PASS = "AdminCode-CodeAdmin-fr/en";

        let user = JSON.parse(localStorage.getItem('mk_session')) || null;
        let db = JSON.parse(localStorage.getItem('mk_db')) || [];
        let logs = JSON.parse(localStorage.getItem('mk_logs')) || [];

        const media = [
            {t: "TF1 DIRECT", u: "https://vcl-v7.unm.is/TF1/index.m3u8", type: "hls"},
            {t: "M6 DIRECT", u: "https://vcl-v7.unm.is/M6/index.m3u8", type: "hls"},
            {t: "BFM TV", u: "https://bfmtv-lh.akamaihd.net/i/bfmtv_1@446033/index_1080_av-p.m3u8", type: "hls"},
            {t: "One Piece (S1 E1)", u: "r72_Vl5X-1c", type: "yt"},
            {t: "Naruto Best Fights", u: "2Yv-8x9YfFw", type: "yt"},
            {t: "Film: Spider-Man Fan", u: "eX0uL-X1E9w", type: "yt"},
            {t: "Dragon Ball Super", u: "Fp9pNPdNwjI", type: "yt"},
            {t: "Masha et Michka", u: "f_Xo_Uq_27A", type: "yt"},
            {t: "Pat' Patrouille", u: "QfEv8Af3Mtk", type: "yt"}
        ];

        window.onload = () => {
            if(user) applySession();
            loadPlaylist();
        };

        function toggleTheme() { document.documentElement.classList.toggle('dark'); }

        function handleAuth() {
            const u = document.getElementById('in-user').value;
            const p = document.getElementById('in-pass').value;
            if(!u || !p) return;

            let existing = db.find(x => x.u === u);
            if(existing) {
                user = existing;
            } else {
                user = { u: u, p: p, hasTv: false };
                db.push(user);
            }
            localStorage.setItem('mk_db', JSON.stringify(db));
            localStorage.setItem('mk_session', JSON.stringify(user));
            applySession();
            closeModal('auth-modal');
        }

        function applySession() {
            document.getElementById('auth-btns').classList.add('hidden');
            const ud = document.getElementById('user-display');
            ud.classList.remove('hidden');
            ud.innerText = user.u;
            if(user.hasTv) document.getElementById('nav-tv-btn').classList.remove('hidden');
        }

        function startChat(prod) {
            if(!user) return openModal('auth-modal');
            openModal('chat-modal');
            document.getElementById('chat-target').innerText = prod;
            document.getElementById('chat-body').innerHTML = `<div class="bg-slate-800 p-3 rounded-xl text-sm max-w-[80%]">Bonjour ! Vous voulez acheter ${prod} ?</div>`;
        }

        function sendMsg() {
            const i = document.getElementById('chat-input');
            if(!i.value) return;
            const body = document.getElementById('chat-body');
            body.innerHTML += `<div class="bg-mk-accent text-black p-3 rounded-xl text-sm self-end ml-auto max-w-[80%]">${i.value}</div>`;
            
            logs.push({ u: user.u, m: i.value, t: new Date().toLocaleTimeString() });
            localStorage.setItem('mk_logs', JSON.stringify(logs));

            setTimeout(() => {
                body.innerHTML += `<div class="bg-slate-800 p-3 rounded-xl text-sm max-w-[80%]">Salut, ${user.u} quelqu'un va te r√©pondre bientot, si tu veut une r√©ponse plus rapide ajoute "mkdevlopper" sur discord!</div>`;
                body.scrollTop = body.scrollHeight;
            }, 1000);
            i.value = "";
        }

        function openTvSection() { 
            document.getElementById('shop-view').classList.add('hidden');
            document.getElementById('tv-view').classList.remove('hidden');
        }

        function closeTvSection() {
            document.getElementById('tv-view').classList.add('hidden');
            document.getElementById('shop-view').classList.remove('hidden');
        }

        function unlockTv() {
            if(document.getElementById('tv-password').value === TV_CODE) {
                document.getElementById('tv-unlock').classList.add('hidden');
                document.getElementById('tv-content').classList.remove('hidden');
            } else { alert("Code invalide !"); }
        }

        function loadPlaylist() {
            const container = document.getElementById('playlist-items');
            media.forEach((m, idx) => {
                container.innerHTML += `
                    <div onclick="play(${idx})" class="p-3 bg-white/5 rounded-xl cursor-pointer hover:bg-mk-accent hover:text-black transition flex items-center gap-3">
                        <span class="text-lg">${m.type === 'yt' ? 'üé¨' : 'üì∫'}</span>
                        <span class="text-xs font-bold">${m.t}</span>
                    </div>`;
            });
        }

        function play(idx) {
            const m = media[idx];
            document.getElementById('current-title').innerText = m.t;
            document.getElementById('player-placeholder').classList.add('hidden');
            
            const ytContainer = document.getElementById('yt-player-container');
            const hlsPlayer = document.getElementById('hls-player');
            const iframe = document.getElementById('yt-iframe');

            if(m.type === 'yt') {
                hlsPlayer.classList.add('hidden');
                hlsPlayer.pause();
                ytContainer.classList.remove('hidden');
                iframe.src = `https://www.youtube.com/embed/${m.u}?autoplay=1`;
            } else {
                ytContainer.classList.add('hidden');
                iframe.src = "";
                hlsPlayer.classList.remove('hidden');
                if (Hls.isSupported()) {
                    const hls = new Hls();
                    hls.loadSource(m.u);
                    hls.attachMedia(hlsPlayer);
                    hls.on(Hls.Events.MANIFEST_PARSED, () => hlsPlayer.play());
                }
            }
        }

        function openAdminAuth() {
            const p = prompt("CODE ADMIN :");
            if(p === ADMIN_PASS) {
                openModal('admin-modal');
                renderAdmin();
            }
        }

        function renderAdmin() {
            const ul = document.getElementById('admin-user-list');
            ul.innerHTML = "";
            db.forEach((u, i) => {
                ul.innerHTML += `
                    <div class="flex justify-between items-center p-2 bg-black rounded border border-white/5">
                        <span class="text-[10px]">${u.u} (${u.p})</span>
                        <button onclick="toggleTvAccess(${i})" class="text-[10px] ${u.hasTv ? 'text-green-500' : 'text-gray-500'}">
                            ${u.hasTv ? '[AUTORIS√â]' : '[DONNER ACC√àS TV]'}
                        </button>
                    </div>`;
            });

            const cl = document.getElementById('admin-chat-logs');
            cl.innerHTML = logs.slice().reverse().map(l => `
                <div class="p-2 bg-black mb-1 rounded text-[10px]">
                    <span class="text-mk-accent">${l.u}:</span> ${l.m}
                </div>
            `).join('');
        }

        function toggleTvAccess(idx) {
            db[idx].hasTv = !db[idx].hasTv;
            localStorage.setItem('mk_db', JSON.stringify(db));
            renderAdmin();
            alert("Acc√®s modifi√© ! L'utilisateur devra se reconnecter ou rafra√Æchir.");
        }

        function openModal(id) { document.getElementById(id).classList.remove('hidden'); }
        function closeModal(id) { document.getElementById(id).classList.add('hidden'); }
    </script>
</body>
</html>
