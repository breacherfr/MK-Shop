<!DOCTYPE html>
<html lang="fr" class="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MK SHOP - V36 ULTIMATE CLOUD</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;800;900&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: { sans: ['Montserrat', 'sans-serif'] },
                    colors: { mkBlue: '#00d2ff', mkRed: '#ff4b5c', mkPurple: '#a363ff', mkYellow: '#fbbf24' }
                }
            }
        }
    </script>
    <style>
        .card-shadow { box-shadow: 0 20px 50px rgba(0,0,0,0.08); }
        .netflix-bg { background: #050505; }
        .btn-black { background: #111827; color: white; transition: all 0.3s; }
        .btn-black:hover { background: #1f2937; transform: translateY(-2px); }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .chat-bubble-me { background: #111827; color: white; border-radius: 18px 18px 0 18px; }
        .chat-bubble-other { background: #f1f5f9; border-radius: 18px 18px 18px 0; }
        .dark .chat-bubble-other { background: #334155; color: white; }
    </style>
</head>
<body class="font-sans text-slate-800 bg-[#f8fafc] dark:bg-[#0f172a] dark:text-white transition-colors duration-300">

    <nav class="bg-white dark:bg-[#1e293b] border-b border-gray-100 dark:border-white/5 px-8 py-4 flex justify-between items-center sticky top-0 z-50">
        <div class="flex items-center gap-2 cursor-pointer" onclick="location.reload()">
            <img src="https://cdn-icons-png.flaticon.com/512/3081/3081840.png" class="w-9 h-9" alt="logo">
            <h1 class="text-2xl font-black italic tracking-tighter text-slate-900 dark:text-white uppercase">MK <span class="text-mkBlue">SHOP</span></h1>
        </div>
        <div class="flex items-center gap-4">
            <button onclick="startChat('Support')" class="hidden md:flex items-center gap-2 bg-slate-100 dark:bg-white/5 px-4 py-2 rounded-full text-[10px] font-bold uppercase hover:bg-mkBlue hover:text-white transition">üéß Support</button>
            <button onclick="toggleTheme()" class="p-2.5 bg-slate-100 dark:bg-slate-800 rounded-full text-xl">üåô</button>
            <div id="user-display" class="hidden flex items-center gap-3">
                <span id="user-name" class="text-xs font-bold bg-mkBlue/10 text-mkBlue px-5 py-2.5 rounded-full border border-mkBlue/20 uppercase"></span>
                <button onclick="logout()" class="text-[10px] font-black text-mkRed uppercase hover:underline">D√©connexion</button>
            </div>
            <div id="auth-btns" class="flex gap-3">
                <button onclick="openModal('auth-modal')" class="bg-mkBlue text-white text-xs font-bold px-6 py-3 rounded-full shadow-xl uppercase">Connexion / Inscription</button>
            </div>
        </div>
    </nav>

    <div id="main-shop">
        <header class="text-center py-20">
            <h2 class="text-7xl font-black italic text-slate-900 dark:text-white tracking-tighter uppercase mb-4">Catalogue Officiel</h2>
            <p class="text-mkBlue font-bold text-sm tracking-[0.5em] uppercase opacity-80">MK CLOUD V36</p>
        </header>

        <main class="max-w-7xl mx-auto px-6 pb-20">
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-10">
                <div class="bg-white dark:bg-[#1e293b] rounded-[2.5rem] p-10 card-shadow border-t-[10px] border-mkBlue flex flex-col">
                    <div class="text-6xl mb-8">üéÆ</div>
                    <h3 class="text-3xl font-black mb-1 italic uppercase tracking-tighter">Comptes Roblox</h3>
                    <ul class="text-sm space-y-4 text-slate-500 dark:text-slate-400 mb-12 flex-1 font-medium mt-4">
                        <li>‚Ä¢ Robux Al√©atoires</li>
                        <li>‚Ä¢ Blox Fruits & Da Hood</li>
                    </ul>
                    <button onclick="startChat('Achat Compte Roblox')" class="btn-black dark:bg-white dark:text-black px-10 py-4 rounded-full font-black text-xs uppercase italic">Acheter</button>
                </div>

                <div class="bg-white dark:bg-[#1e293b] rounded-[2.5rem] p-10 card-shadow border-t-[10px] border-cyan-400 flex flex-col">
                    <div class="text-6xl mb-8">üì∫</div>
                    <h3 class="text-3xl font-black mb-1 italic uppercase tracking-tighter">TV & Anim√©s</h3>
                    <div class="bg-slate-50 dark:bg-black/20 border border-slate-100 dark:border-white/5 rounded-2xl p-5 mt-8 mb-8">
                        <input id="tv-code-field" type="text" placeholder="CODE-ACHET√â-..." class="bg-transparent text-xs font-mono outline-none w-full text-mkBlue font-bold">
                    </div>
                    <button id="tv-main-btn" onclick="checkTvCode()" class="btn-black dark:bg-white dark:text-black px-10 py-4 rounded-full font-black text-xs uppercase italic">V√©rifier</button>
                </div>

                <div class="bg-white dark:bg-[#1e293b] rounded-[2.5rem] p-10 card-shadow border-t-[10px] border-mkRed flex flex-col">
                    <div class="text-6xl mb-8">üéØ</div>
                    <h3 class="text-3xl font-black mb-1 italic text-mkRed uppercase tracking-tighter">Cheat Roblox</h3>
                    <ul class="text-sm space-y-4 text-slate-500 dark:text-slate-400 mb-12 flex-1 font-medium mt-4">
                        <li>‚Ä¢ Executors PC/Mobile</li>
                        <li>‚Ä¢ Scripts Priv√©s</li>
                    </ul>
                    <button onclick="startChat('Achat Cheat')" class="btn-black dark:bg-white dark:text-black px-10 py-4 rounded-full font-black text-xs uppercase italic">Acheter</button>
                </div>

                <div class="bg-white dark:bg-[#1e293b] rounded-[2.5rem] p-10 card-shadow border-t-[10px] border-mkYellow flex flex-col">
                    <div class="text-6xl mb-8">‚≠ê</div>
                    <h3 class="text-3xl font-black mb-1 italic uppercase tracking-tighter">Comptes Premium</h3>
                    <ul class="text-sm space-y-4 text-slate-500 dark:text-slate-400 mb-12 flex-1 font-medium mt-4">
                        <li>‚Ä¢ Spotify / Netflix / Disney</li>
                        <li>‚Ä¢ Comptes √† Vie</li>
                    </ul>
                    <button onclick="startChat('Premium')" class="btn-black dark:bg-white dark:text-black px-10 py-4 rounded-full font-black text-xs uppercase italic">Acheter</button>
                </div>

                <div class="bg-white dark:bg-[#1e293b] rounded-[2.5rem] p-10 card-shadow border-t-[10px] border-mkPurple md:col-span-2 flex flex-col md:flex-row items-center gap-10">
                    <div class="text-8xl">‚ú®</div>
                    <div class="flex-1">
                        <h3 class="text-3xl font-black mb-2 text-mkPurple uppercase italic tracking-tighter">Demande Sp√©ciale</h3>
                        <p class="text-sm text-slate-500 dark:text-slate-400 italic">Un besoin pr√©cis ? Contacte le support.</p>
                    </div>
                    <button onclick="startChat('Demande Perso')" class="bg-mkPurple text-white px-12 py-5 rounded-full font-black text-xs uppercase italic">Contacter</button>
                </div>
            </div>
        </main>

        <footer class="py-10 text-center">
            <button onclick="openModal('admin-auth-modal')" class="text-[10px] text-slate-300 dark:text-slate-600 font-bold uppercase hover:text-mkRed transition">Acc√®s Administration</button>
        </footer>
    </div>

    <div id="tv-section" class="hidden fixed inset-0 z-[60] netflix-bg overflow-y-auto">
        <nav class="p-8 flex justify-between items-center sticky top-0 bg-black/95 backdrop-blur-xl z-20 border-b border-white/5">
            <h2 class="text-3xl font-black italic text-mkBlue uppercase tracking-tighter">MK <span class="text-white">STREAM</span></h2>
            <button onclick="closeTv()" class="text-white bg-mkRed px-8 py-3 rounded-full text-xs font-black uppercase italic">Quitter</button>
        </nav>
        <div id="catalog-view" class="p-10 space-y-20 pb-40">
            <section>
                <h3 class="text-2xl font-black text-white mb-8 pl-5 border-l-4 border-mkBlue uppercase italic">Mangas & Anim√©s</h3>
                <div id="row-shonen" class="flex gap-6 overflow-x-auto no-scrollbar"></div>
            </section>
            <section>
                <h3 class="text-2xl font-black text-white mb-8 pl-5 border-l-4 border-yellow-500 uppercase italic">Dessins Anim√©s</h3>
                <div id="row-cartoons" class="flex gap-6 overflow-x-auto no-scrollbar"></div>
            </section>
        </div>
        <div id="episode-view" class="hidden p-10 max-w-7xl mx-auto">
            <button onclick="backToCatalog()" class="text-mkBlue font-black mb-10 uppercase text-xs tracking-widest">‚Üê Retour</button>
            <h2 id="ep-title" class="text-6xl font-black text-white uppercase italic mb-10">---</h2>
            <div id="ep-list" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-8"></div>
        </div>
    </div>

    <div id="player-overlay" class="hidden fixed inset-0 z-[100] bg-black flex flex-col">
        <div class="p-5 flex justify-between bg-black text-white items-center">
            <span id="player-title" class="font-black text-xs uppercase text-mkBlue italic">Lecture HD</span>
            <button onclick="stopVideo()" class="bg-white/10 w-10 h-10 rounded-full flex items-center justify-center">‚úï</button>
        </div>
        <div class="flex-1 bg-black"><iframe id="ifr-player" class="w-full h-full" allow="autoplay; fullscreen" frameborder="0"></iframe></div>
    </div>

    <div id="chat-modal" class="hidden fixed inset-0 z-[100] bg-slate-900/60 backdrop-blur-sm flex items-center justify-center p-4">
        <div class="bg-white dark:bg-[#1e293b] w-full max-w-lg h-[650px] rounded-[3rem] flex flex-col overflow-hidden">
            <div class="bg-slate-900 p-7 text-white flex justify-between items-center font-black italic uppercase text-sm">
                <span>Support MK SHOP</span> <button onclick="closeModal('chat-modal')">‚úï</button>
            </div>
            <div id="chat-body" class="flex-1 p-8 overflow-y-auto space-y-6"></div>
            <div class="p-6 flex gap-4 border-t border-white/5">
                <input id="chat-input" type="text" placeholder="Message..." class="flex-1 bg-slate-100 dark:bg-slate-800 rounded-full px-8 outline-none text-sm">
                <button onclick="sendMessage()" class="bg-mkBlue text-white w-14 h-14 rounded-full font-black">‚û§</button>
            </div>
        </div>
    </div>

    <div id="admin-panel" class="hidden fixed inset-0 z-[120] bg-[#0f172a] text-white p-6 md:p-12 overflow-y-auto">
        <div class="max-w-6xl mx-auto">
            <div class="flex justify-between items-center mb-12 border-b border-white/10 pb-6">
                <h2 class="text-mkBlue font-black italic text-3xl uppercase tracking-tighter">MK_CLOUD_MANAGER</h2>
                <button onclick="closeModal('admin-panel')" class="bg-mkRed px-6 py-2 rounded-full font-black text-[10px] uppercase">Fermer</button>
            </div>
            <div id="admin-user-list" class="space-y-4"></div>
        </div>
    </div>

    <div id="auth-modal" class="hidden fixed inset-0 z-[100] bg-slate-900/80 backdrop-blur-md flex items-center justify-center p-4">
        <div class="bg-white dark:bg-[#1e293b] p-12 rounded-[3rem] w-full max-w-md text-center">
            <h3 class="text-3xl font-black mb-10 italic uppercase">Acc√®s MK SHOP</h3>
            <input id="in-user" type="text" placeholder="Pseudo" class="w-full bg-slate-50 dark:bg-black/40 border p-5 rounded-2xl mb-5 outline-none font-bold">
            <input id="in-pass" type="password" placeholder="Mot de passe" class="w-full bg-slate-50 dark:bg-black/40 border p-5 rounded-2xl mb-10 outline-none font-bold">
            <button onclick="handleAuth()" class="w-full bg-mkBlue text-white font-black py-5 rounded-full uppercase italic">Valider</button>
            <button onclick="closeModal('auth-modal')" class="mt-4 text-[10px] font-black opacity-50 uppercase">Fermer</button>
        </div>
    </div>

    <div id="admin-auth-modal" class="hidden fixed inset-0 z-[110] bg-black/90 backdrop-blur-md flex items-center justify-center p-4">
        <div class="bg-[#1e293b] p-10 rounded-[2.5rem] w-full max-w-sm text-center">
            <h3 class="text-2xl font-black mb-8 italic text-mkRed uppercase">Code Admin</h3>
            <input id="admin-pass-input" type="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢" class="w-full bg-black/40 p-5 rounded-2xl mb-6 outline-none font-bold text-center text-white">
            <button onclick="verifyAdmin()" class="w-full bg-mkRed text-white font-black py-5 rounded-full uppercase italic">Acc√©der</button>
        </div>
    </div>

    <script>
        // CONFIG
        const SB_URL = "https://eeiuxfcgysrarctokuyg.supabase.co";
        const SB_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."; // Mets ta cl√© compl√®te ici
        const supabase = (typeof supabase !== 'undefined') ? supabase.createClient(SB_URL, SB_KEY) : null;
        const ADMIN_PASS = "admin123";
        const TV_CODE = "ACCES-ACHETER-0001";

        // DONN√âES VID√âO
        const content = [
            { id: 0, category: "shonen", title: "One Piece", poster: "https://image.animationdigitalnetwork.fr/license/onepiece/arc5/web/affiche_350x500.jpg", episodes: [{t:"√âpisode 1", u:"BxuMkEvNagQ"}] },
            { id: 1, category: "shonen", title: "Naruto", poster: "https://zqwqz.org/img/naruto-classic-1622930404.jpg", episodes: Array.from({length:10}, (_, i) => ({t:`√âpisode ${i+1}`, u:"FoVvpkMlTqM"})) },
            { id: 6, category: "cartoons", title: "Bob l'√âponge", poster: "https://www.topkool.com/fr/wp-content/uploads/2013/04/bob-l-eponge-022.jpg", episodes: Array.from({length:10}, (_, i) => ({t:`√âpisode ${i+1}`, u:"dhJtWThO5kw"})) },
            { id: 7, category: "cartoons", title: "Gumball", isComingSoon: true, poster: "https://quotecatalog.imgix.net/assets/title-sbTftntUdiZ67GmtaPYjAjyX/original.jpg?w=400&h=600&fit=crop", episodes: [] }
        ];

        let user = JSON.parse(localStorage.getItem('mk_session')) || null;
        let db = JSON.parse(localStorage.getItem('mk_db_cloud')) || []; // Sync cloud simul√©e tant que la table Supabase n'est pas configur√©e

        window.onload = () => {
            if(user) applySession();
            renderCatalog();
        };

        // AUTH & SESSION
        function handleAuth() {
            const u = document.getElementById('in-user').value.trim();
            const p = document.getElementById('in-pass').value;
            if(!u || !p) return;
            let found = db.find(x => x.u === u);
            if(found) {
                if(found.p === p) user = found;
                else return alert("Mauvais mot de passe");
            } else {
                user = { u, p, hasTv: false, messages: [], id: Date.now() };
                db.push(user);
            }
            localStorage.setItem('mk_db_cloud', JSON.stringify(db));
            localStorage.setItem('mk_session', JSON.stringify(user));
            location.reload();
        }

        function applySession() {
            document.getElementById('auth-btns').classList.add('hidden');
            document.getElementById('user-display').classList.remove('hidden');
            document.getElementById('user-name').innerText = user.u;
            if(user.hasTv) document.getElementById('tv-main-btn').innerText = "ACC√âDER";
        }

        function logout() { localStorage.removeItem('mk_session'); location.reload(); }

        // TV & VID√âOS
        function renderCatalog() {
            content.forEach(item => {
                const html = `<div onclick="${item.isComingSoon ? '' : `showEpisodes(${item.id})`}" class="relative min-w-[220px] h-[320px] rounded-[2rem] bg-cover bg-center cursor-pointer hover:scale-105 transition shadow-2xl" style="background-image: url('${item.poster}')">
                    ${item.isComingSoon ? '<div class="absolute inset-0 bg-black/60 flex items-center justify-center rounded-[2rem]"><span class="bg-mkRed text-white text-[10px] font-black px-3 py-1 rounded-full uppercase">Bient√¥t</span></div>' : ''}
                </div>`;
                document.getElementById(`row-${item.category}`).innerHTML += html;
            });
        }

        function showEpisodes(id) {
            const item = content.find(x => x.id === id);
            document.getElementById('catalog-view').classList.add('hidden');
            document.getElementById('episode-view').classList.remove('hidden');
            document.getElementById('ep-title').innerText = item.title;
            const list = document.getElementById('ep-list'); list.innerHTML = "";
            item.episodes.forEach(ep => {
                list.innerHTML += `<div onclick="playVideo('${ep.u}')" class="cursor-pointer group"><div class="relative overflow-hidden rounded-2xl mb-2"><img src="https://img.youtube.com/vi/${ep.u}/mqdefault.jpg" class="w-full"></div><h4 class="text-white font-bold text-xs uppercase">${ep.t}</h4></div>`;
            });
        }

        function playVideo(u) { document.getElementById('player-overlay').classList.remove('hidden'); document.getElementById('ifr-player').src = `https://www.youtube.com/embed/${u}?autoplay=1`; }
        function stopVideo() { document.getElementById('player-overlay').classList.add('hidden'); document.getElementById('ifr-player').src = ""; }
        function checkTvCode() { if(document.getElementById('tv-code-field').value === TV_CODE || (user && user.hasTv)) { document.getElementById('tv-section').classList.remove('hidden'); } else alert("Code invalide"); }
        function closeTv() { document.getElementById('tv-section').classList.add('hidden'); }
        function backToCatalog() { document.getElementById('episode-view').classList.add('hidden'); document.getElementById('catalog-view').classList.remove('hidden'); }

        // CHAT & ADMIN
        function startChat() { if(!user) return openModal('auth-modal'); openModal('chat-modal'); renderMessages(); }
        function renderMessages() {
            const b = document.getElementById('chat-body');
            b.innerHTML = (user.messages || []).map(m => `<div class="flex ${m.from === 'me' ? 'justify-end' : 'justify-start'}"><div class="${m.from === 'me' ? 'chat-bubble-me' : 'chat-bubble-other'} p-4 text-xs">${m.txt}</div></div>`).join('');
            b.scrollTop = b.scrollHeight;
        }

        function sendMessage() {
            const i = document.getElementById('chat-input'); if(!i.value) return;
            user.messages.push({ from: 'me', txt: i.value });
            i.value = ""; renderMessages(); saveCloud();
        }

        function verifyAdmin() { if(document.getElementById('admin-pass-input').value === ADMIN_PASS) { closeModal('admin-auth-modal'); openModal('admin-panel'); renderAdmin(); } }
        function renderAdmin() {
            const list = document.getElementById('admin-user-list');
            list.innerHTML = db.map((u, i) => `
                <div class="bg-[#1e293b] p-6 rounded-2xl border border-white/5 flex flex-col gap-4">
                    <div class="flex justify-between">
                        <div><h4 class="font-bold text-mkBlue">${u.u}</h4><p class="text-[10px] opacity-50">PASS: ${u.p}</p></div>
                        <div class="flex gap-2">
                            <button onclick="adminBan(${i})" class="bg-mkRed text-white px-3 py-1 rounded text-[10px]">BANNIR</button>
                            <button onclick="adminToggleTv(${i})" class="bg-slate-700 px-3 py-1 rounded text-[10px]">${u.hasTv ? 'TV OK' : 'OFF'}</button>
                        </div>
                    </div>
                    <div class="bg-black/20 p-3 rounded text-[10px]">
                        ${(u.messages || []).map(m => `<p>${m.from==='me'?'Client':'Moi'}: ${m.txt}</p>`).join('')}
                    </div>
                    <div class="flex gap-2">
                        <input id="rep-${i}" type="text" placeholder="R√©ponse..." class="flex-1 bg-black/40 p-2 rounded text-xs outline-none">
                        <button onclick="adminReply(${i})" class="bg-mkYellow text-black px-4 font-bold rounded text-[10px]">ENVOYER</button>
                    </div>
                </div>
            `).join('');
        }

        function adminReply(i) {
            const txt = document.getElementById(`rep-${i}`).value; if(!txt) return;
            db[i].messages.push({ from: 'support', txt: txt });
            if(user && user.u === db[i].u) user = db[i];
            saveCloud(); renderAdmin();
        }

        function adminBan(i) { if(confirm("Supprimer ?")) { db.splice(i, 1); saveCloud(); renderAdmin(); } }
        function adminToggleTv(i) { db[i].hasTv = !db[i].hasTv; saveCloud(); renderAdmin(); }

        function saveCloud() { 
            localStorage.setItem('mk_db_cloud', JSON.stringify(db)); 
            if(user) localStorage.setItem('mk_session', JSON.stringify(user));
        }

        function openModal(id) { document.getElementById(id).classList.remove('hidden'); }
        function closeModal(id) { document.getElementById(id).classList.add('hidden'); }
        function toggleTheme() { document.documentElement.classList.toggle('dark'); }
    </script>
</body>
</html>
