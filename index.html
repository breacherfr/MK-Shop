<!DOCTYPE html>
<html lang="fr" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MK SHOP - V37 OFFICIAL</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;800;900&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: { sans: ['Montserrat', 'sans-serif'] },
                    colors: { 
                        mkBlue: '#00d2ff', mkRed: '#ff4b5c', mkPurple: '#a363ff', 
                        mkYellow: '#fbbf24', mkGreen: '#22c55e', mkAdmin: '#ff00ff'
                    }
                }
            }
        }
    </script>
    <style>
        :root { --bg-body: #050505; --text-main: #ffffff; --glass: rgba(20, 20, 25, 0.85); --border: rgba(255,255,255,0.08); }
        .light { --bg-body: #f3f4f6; --text-main: #111827; --glass: rgba(255, 255, 255, 0.9); --border: rgba(0,0,0,0.1); }
        body { background-color: var(--bg-body); color: var(--text-main); transition: 0.4s; font-family: 'Montserrat', sans-serif; overflow-x: hidden; }
        .glass { background: var(--glass); backdrop-filter: blur(20px); border: 1px solid var(--border); }
        .nav-link { font-size: 11px; font-weight: 900; text-transform: uppercase; cursor: pointer; padding: 12px 24px; border-radius: 99px; transition: 0.3s; }
        .active-link { background: #00d2ff !important; color: black !important; box-shadow: 0 10px 20px rgba(0, 210, 255, 0.3); }
        .shop-card { transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        .shop-card:hover { transform: translateY(-15px); box-shadow: 0 20px 40px rgba(0,0,0,0.4); }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .msg-bubble { max-width: 85%; padding: 12px 16px; border-radius: 20px; font-size: 12px; }
    </style>
</head>
<body>

    <nav class="glass sticky top-0 z-[100] px-8 py-5 flex justify-between items-center border-b">
        <div class="flex items-center gap-10">
            <div class="flex items-center gap-3 cursor-pointer group" onclick="showSection('shop')">
                <div class="w-12 h-12 bg-mkBlue rounded-2xl flex items-center justify-center shadow-lg shadow-mkBlue/40 group-hover:rotate-12 transition-transform">
                    <span class="text-black font-black text-2xl">MK</span>
                </div>
                <div class="flex flex-col">
                    <h1 class="text-2xl font-black italic tracking-tighter uppercase leading-none">MK <span class="text-mkBlue">SHOP</span></h1>
                    <span class="text-[8px] font-black uppercase tracking-[0.4em] opacity-40">Digital Excellence</span>
                </div>
            </div>
            
            <div class="hidden lg:flex gap-3 bg-black/20 p-1.5 rounded-full border border-white/5">
                <button id="nav-shop" class="nav-link active-link" onclick="showSection('shop')">üõí Boutique</button>
                <button id="nav-gamble" class="nav-link" onclick="showSection('gamble')">üé≤ Jeux</button>
                <button id="nav-leaderboard" class="nav-link" onclick="showSection('leaderboard')">üèÜ Top 10</button>
                <button id="nav-profile" class="nav-link" onclick="showSection('profile')">üë§ Profil</button>
                <button id="nav-admin" class="nav-link hidden text-mkAdmin border border-mkAdmin/20" onclick="showSection('admin')">‚ö° Admin</button>
            </div>
        </div>

        <div class="flex items-center gap-4">
            <div id="nav-stats" class="hidden flex items-center gap-4">
                <div class="flex items-center gap-2 bg-black/40 px-4 py-2 rounded-xl border border-white/10 shadow-inner">
                    <span class="text-[9px] font-black text-mkGreen uppercase italic">Cash</span>
                    <span id="nav-balance-val" class="text-sm font-black text-white">0.00‚Ç¨</span>
                </div>
                <div class="flex items-center gap-2 bg-black/40 px-4 py-2 rounded-xl border border-white/10 shadow-inner">
                    <span class="text-[9px] font-black text-mkYellow uppercase italic">XP</span>
                    <span id="nav-xp-val" class="text-sm font-black text-white">0</span>
                </div>
            </div>

            <button onclick="toggleTheme()" class="w-11 h-11 flex items-center justify-center bg-white/5 rounded-2xl hover:bg-white/10 transition border border-white/5">
                <span id="theme-icon">üåô</span>
            </button>

            <div id="user-display" class="hidden flex items-center gap-3 bg-white/5 p-2 pr-5 rounded-2xl border border-white/10">
                <img id="user-pfp-nav" src="https://via.placeholder.com/50" class="w-10 h-10 rounded-xl object-cover border-2 border-mkBlue">
                <span id="user-name" class="text-[11px] font-black uppercase">---</span>
                <button onclick="logout()" class="ml-4 text-mkRed font-black text-xs">‚úï</button>
            </div>

            <button id="auth-btn" onclick="openModal('auth-modal')" class="bg-mkBlue text-black text-[11px] font-black px-8 py-3.5 rounded-2xl uppercase hover:shadow-xl transition-all">Connexion</button>
        </div>
    </nav>

    <aside class="fixed right-6 top-28 bottom-8 w-80 glass rounded-[3rem] hidden xl:flex flex-col overflow-hidden z-[40]">
        <div class="p-6 bg-mkBlue/10 border-b border-white/5 text-mkBlue font-black uppercase text-[12px] italic tracking-widest">Global Chat</div>
        <div id="public-messages" class="flex-1 p-6 overflow-y-auto space-y-5 no-scrollbar"></div>
        <div class="p-6 pt-2">
            <div class="flex gap-2 bg-black/40 p-2.5 rounded-[1.5rem] border border-white/10">
                <input id="public-input" type="text" placeholder="Message..." class="bg-transparent border-none outline-none text-[12px] flex-1 px-3">
                <button onclick="sendPublicMessage()" class="w-12 h-12 bg-mkBlue text-black rounded-2xl font-black text-xl">‚û§</button>
            </div>
        </div>
    </aside>

    <aside id="support-chat-ui" class="fixed left-6 bottom-28 w-80 glass rounded-[3rem] hidden flex flex-col overflow-hidden z-[50] border-l-4 border-mkRed shadow-2xl">
        <div class="p-5 bg-mkRed/10 border-b border-white/5 flex justify-between items-center text-mkRed font-black uppercase text-[11px]">Support Staff</div>
        <div id="support-messages" class="h-80 p-5 overflow-y-auto space-y-4 text-[12px] no-scrollbar"></div>
        <div class="p-5 border-t border-white/5 bg-black/20">
            <input id="support-input" type="text" placeholder="Pose ta question..." class="w-full bg-black/30 p-4 rounded-2xl text-[12px] outline-none mb-3 border border-white/5">
            <button onclick="sendSupportMessage()" class="w-full bg-mkRed py-4 rounded-2xl text-[11px] font-black uppercase">Envoyer</button>
        </div>
    </aside>
    <button onclick="document.getElementById('support-chat-ui').classList.toggle('hidden')" class="fixed left-8 bottom-8 w-16 h-16 bg-mkRed rounded-[2rem] flex items-center justify-center text-3xl z-[60] shadow-2xl border-2 border-white/10">üéß</button>

    <main class="max-w-7xl mx-auto px-8 py-16 lg:pr-[380px]">
        
        <div id="section-shop" class="content-section space-y-16">
            <header class="space-y-4">
                <h2 class="text-6xl font-black italic uppercase tracking-tighter leading-none">MK <span class="text-mkBlue">SHOP</span></h2>
                <div class="h-1.5 w-24 bg-mkBlue rounded-full"></div>
            </header>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-10">
                <div class="shop-card glass p-10 rounded-[4rem] border-t-8 border-mkBlue">
                    <span class="bg-mkBlue/10 text-mkBlue px-5 py-1.5 rounded-full text-[10px] font-black uppercase border border-mkBlue/20">Streaming üì∫</span>
                    <h3 class="text-4xl font-black uppercase italic mt-6 tracking-tighter">Cloud Stream</h3>
                    <p class="text-[12px] font-medium opacity-60 mt-4 mb-10">Anim√©s & D√©ssins Anim√©s HD Illimit√©s.</p>
                    <div class="text-3xl font-black mb-8">2.50‚Ç¨/Mois</div>
                    <button onclick="startSupport('STREAM')" class="w-full bg-white text-black py-5 rounded-[2rem] font-black text-[12px] uppercase">Commander/Acceder</button>
                </div>

                <div class="shop-card glass p-10 rounded-[4rem] border-t-8 border-mkPurple">
                    <span class="bg-mkPurple/10 text-mkPurple px-5 py-1.5 rounded-full text-[10px] font-black uppercase border border-mkPurple/20">Roblox üéÆ</span>
                    <h3 class="text-4xl font-black uppercase italic mt-6 tracking-tighter text-mkPurple">Roblox Market</h3>
                    <p class="text-[12px] font-medium opacity-60 mt-4 mb-10">Comptes Roblox & Robux pas chers.</p>
                    <div class="text-3xl font-black mb-8">5.00‚Ç¨ - 30.00‚Ç¨</div>
                    <button onclick="startSupport('ROBLOX')" class="w-full bg-mkPurple text-white py-5 rounded-[2rem] font-black text-[12px] uppercase">Commander</button>
                </div>

                <div class="shop-card glass p-10 rounded-[4rem] border-t-8 border-mkYellow">
                    <span class="bg-mkYellow/10 text-mkYellow px-5 py-1.5 rounded-full text-[10px] font-black uppercase border border-mkYellow/20">Comptes ‚≠ê</span>
                    <h3 class="text-4xl font-black uppercase italic mt-6 tracking-tighter text-mkYellow">Premium Subs</h3>
                    <p class="text-[12px] font-medium opacity-60 mt-4 mb-10">Netflix, Spotify, Disney+.</p>
                    <div class="text-3xl font-black mb-8">3.00‚Ç¨ - 20.00‚Ç¨</div>
                    <button onclick="startSupport('SUBS')" class="w-full bg-mkYellow text-black py-5 rounded-[2rem] font-black text-[12px] uppercase">Commander</button>
                </div>

                <div class="shop-card glass p-10 rounded-[4rem] border-t-8 border-mkRed">
                    <span class="bg-mkRed/10 text-mkRed px-5 py-1.5 rounded-full text-[10px] font-black uppercase border border-mkRed/20">Software üéØ</span>
                    <h3 class="text-4xl font-black uppercase italic mt-6 tracking-tighter text-mkRed">Scripts & Hubs</h3>
                    <p class="text-[12px] font-medium opacity-60 mt-4 mb-10">Executors & Exploits priv√©s.</p>
                    <div class="text-3xl font-black mb-8">6.00‚Ç¨ - 12.00‚Ç¨</div>
                    <button onclick="startSupport('SCRIPTS')" class="w-full bg-mkRed text-white py-5 rounded-[2rem] font-black text-[12px] uppercase">Commander</button>
                </div>
            </div>
        </div>

        <div id="section-gamble" class="content-section hidden space-y-16">
            <h2 class="text-5xl font-black italic uppercase text-center">CASINO <span class="text-mkYellow">MK</span></h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-12">
                <div class="glass p-12 rounded-[4rem] text-center border-b-8 border-mkYellow">
                    <h3 class="text-3xl font-black uppercase mb-10 italic">Coin Flip</h3>
                    <div id="coin-visual" class="w-32 h-32 bg-mkYellow rounded-full mx-auto mb-12 flex items-center justify-center text-5xl shadow-2xl border-4 border-white/30 transition-all duration-700">ü™ô</div>
                    <input id="bet-coin" type="number" value="1.00" class="bg-black/20 w-full p-6 rounded-[2rem] text-center text-3xl font-black outline-none mb-6">
                    <div class="flex gap-4">
                        <button onclick="playCoin('heads')" class="flex-1 bg-mkBlue text-black font-black py-5 rounded-2xl uppercase">Pile</button>
                        <button onclick="playCoin('tails')" class="flex-1 bg-mkPurple text-white font-black py-5 rounded-2xl uppercase">Face</button>
                    </div>
                </div>
                <div class="glass p-12 rounded-[4rem] text-center border-b-8 border-mkRed">
                    <h3 class="text-3xl font-black uppercase mb-10 italic">Dice Roll</h3>
                    <div id="dice-visual" class="text-8xl mb-12 h-32 flex items-center justify-center">üé≤</div>
                    <input id="bet-dice" type="number" value="1.00" class="bg-black/20 w-full p-6 rounded-[2rem] text-center text-3xl font-black outline-none mb-6">
                    <button onclick="playDice()" class="w-full bg-mkRed text-white py-5 rounded-2xl font-black uppercase">Lancer</button>
                </div>
            </div>
        </div>

        <div id="section-leaderboard" class="content-section hidden">
            <h2 class="text-5xl font-black italic uppercase tracking-tighter text-center mb-16">CLASSEMENT <span class="text-mkYellow">TOP 10</span></h2>
            <div id="leader-list" class="space-y-4 max-w-3xl mx-auto"></div>
        </div>

        <div id="section-profile" class="content-section hidden">
            <div class="max-w-2xl mx-auto glass p-12 rounded-[4rem]">
                <div class="flex items-center gap-10 mb-12">
                    <img id="prof-pfp" src="https://via.placeholder.com/150" class="w-40 h-40 rounded-[3rem] border-4 border-mkBlue object-cover">
                    <div>
                        <h2 id="prof-user" class="text-5xl font-black italic uppercase leading-none tracking-tighter">---</h2>
                        <div class="flex gap-4 mt-4">
                            <span id="prof-balance" class="bg-mkGreen/10 text-mkGreen px-4 py-1.5 rounded-full font-black border border-mkGreen/20">0.00‚Ç¨</span>
                            <span id="prof-xp" class="bg-mkYellow/10 text-mkYellow px-4 py-1.5 rounded-full font-black border border-mkYellow/20">0 XP</span>
                        </div>
                    </div>
                </div>

                <div class="bg-white/5 p-8 rounded-[2.5rem] border border-white/10 mb-8">
                    <p class="text-[10px] font-black uppercase opacity-40 mb-4 tracking-widest italic">üéüÔ∏è Code Promo</p>
                    <div class="flex gap-4">
                        <input id="in-promo" type="text" placeholder="ENTRER CODE" class="flex-1 bg-black/40 p-5 rounded-2xl outline-none text-[11px] font-black border border-white/5">
                        <button onclick="redeemPromo()" class="bg-mkGreen text-black px-8 rounded-2xl font-black text-[10px] uppercase">Valider</button>
                    </div>
                </div>

                <input id="input-pfp" type="text" placeholder="URL Image Profil" class="w-full bg-black/40 p-5 rounded-2xl outline-none text-[11px] font-bold border border-white/5">
                <button onclick="updatePFP()" class="w-full bg-mkBlue text-black py-5 rounded-2xl mt-4 font-black uppercase text-[10px]">Sauvegarder</button>
            </div>
        </div>

        <div id="section-admin" class="content-section hidden">
            <div class="glass p-12 rounded-[4rem] border-t-8 border-mkAdmin">
                <h2 class="text-4xl font-black text-mkAdmin italic uppercase mb-12">Gestion MK</h2>
                <div class="overflow-x-auto"><table class="w-full text-left text-xs font-bold"><tbody id="admin-user-list"></tbody></table></div>
            </div>
        </div>
    </main>

    <div id="auth-modal" class="hidden fixed inset-0 z-[1000] bg-black/98 backdrop-blur-2xl flex items-center justify-center p-6">
        <div class="glass p-16 rounded-[5rem] w-full max-w-lg text-center border-t-[10px] border-mkBlue">
            <h3 class="text-4xl font-black mb-8 italic uppercase tracking-tighter">ACC√àS <span class="text-mkBlue">MK SHOP</span></h3>
            <div class="space-y-4">
                <input id="in-user" type="text" placeholder="PSEUDO" class="w-full bg-white/5 p-6 rounded-[2rem] outline-none font-black text-center text-xl border border-white/10">
                <input id="in-pass" type="password" placeholder="MOT DE PASSE" class="w-full bg-white/5 p-6 rounded-[2rem] outline-none font-black text-center text-xl border border-white/10">
                <input id="in-email" type="email" placeholder="EMAIL (OPTIONNEL)" class="w-full bg-white/5 p-6 rounded-[2rem] outline-none font-black text-center text-lg border border-white/10 opacity-60">
                <button onclick="handleAuth()" class="w-full bg-mkBlue text-black font-black py-6 rounded-[2rem] uppercase mt-4">Connexion / Inscription</button>
            </div>
            <button onclick="closeModal('auth-modal')" class="mt-8 text-[10px] font-black opacity-20 uppercase">Retour</button>
        </div>
    </div>

    <script>
        const SB_URL = "https://eeiuxfcgysrarctokuyg.supabase.co"; 
        const SB_KEY = "sb_publishable_0fuup_i-vDgKHozqpz706A_4tGWghxn";
        const db = supabase.createClient(SB_URL, SB_KEY);
        let user = null;

        function showSection(id) {
            document.querySelectorAll('.content-section').forEach(s => s.classList.add('hidden'));
            document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active-link'));
            document.getElementById('section-' + id).classList.remove('hidden');
            if(document.getElementById('nav-' + id)) document.getElementById('nav-' + id).classList.add('active-link');
            if(id === 'leaderboard') fetchLeaderboard();
            if(id === 'admin') fetchAdminUsers();
        }

        async function handleAuth() {
            const username = document.getElementById('in-user').value.trim();
            const pass = document.getElementById('in-pass').value.trim();
            const email = document.getElementById('in-email').value.trim();
            
            if(!username || !pass) return alert("Remplis les champs !");

            try {
                // On cherche l'utilisateur. maybeSingle() ne crash pas si rien n'est trouv√©.
                let { data: profile, error: searchError } = await db
                    .from('profiles')
                    .select('*')
                    .eq('username', username)
                    .maybeSingle();

                if (searchError) throw searchError;

                if (!profile) {
                    // INSCRIPTION : Si le profil n'existe pas, on le cr√©e
                    const { data: newP, error: insertError } = await db
                        .from('profiles')
                        .insert([{ 
                            username: username, 
                            password: pass, 
                            email: email, 
                            balance: 5.00, 
                            xp: 0, 
                            messages: [] 
                        }])
                        .select()
                        .single();
                    
                    if (insertError) throw insertError;
                    profile = newP;
                    alert("Compte cr√©√© avec succ√®s !");
                } else {
                    // CONNEXION : Si le profil existe, on check le mot de passe
                    if(profile.password !== pass) {
                        return alert("Mauvais mot de passe pour ce pseudo !");
                    }
                }

                // Une fois connect√©
                user = profile;
                if(user.username.toLowerCase() === 'admin') document.getElementById('nav-admin').classList.remove('hidden');
                syncUser(); 
                closeModal('auth-modal'); 
                fetchPublicMessages();
                
                // Souscription au chat
                db.channel('public_chat').on('postgres_changes', { event: 'INSERT', schema: 'public', table: 'public_chat' }, fetchPublicMessages).subscribe();

            } catch (err) {
                console.error(err);
                alert("Erreur Supabase : V√©rifie tes Policies RLS !");
            }
        }

        function syncUser() {
            if(!user) return;
            document.getElementById('user-display').classList.remove('hidden');
            document.getElementById('nav-stats').classList.remove('hidden');
            document.getElementById('auth-btn').classList.add('hidden');
            
            document.getElementById('user-name').innerText = user.username;
            document.getElementById('nav-balance-val').innerText = user.balance.toFixed(2) + "‚Ç¨";
            document.getElementById('nav-xp-val').innerText = Math.floor(user.xp);
            
            document.getElementById('prof-user').innerText = user.username;
            document.getElementById('prof-balance').innerText = user.balance.toFixed(2) + "‚Ç¨";
            document.getElementById('prof-xp').innerText = Math.floor(user.xp) + " XP";
            
            if(user.pfp) { document.getElementById('user-pfp-nav').src = user.pfp; document.getElementById('prof-pfp').src = user.pfp; }
            renderSupport();
        }

        async function redeemPromo() {
            const code = document.getElementById('in-promo').value.trim().toUpperCase();
            if(code === "LXS-1") { 
                const { data } = await db.from('profiles').update({ balance: user.balance + 10.00 }).eq('id', user.id).select().single();
                user = data; syncUser(); alert("Code valid√© ! +10‚Ç¨");
            } else { alert("Code invalide !"); }
        }

        async function playCoin(side) {
            const bet = parseFloat(document.getElementById('bet-coin').value);
            if(!user || bet > user.balance || bet <= 0) return alert("Solde insuffisant");
            const win = Math.random() > 0.55;
            const newBal = win ? user.balance + bet : user.balance - bet;
            const { data } = await db.from('profiles').update({ balance: newBal, xp: user.xp + (bet*0.5) }).eq('id', user.id).select().single();
            user = data; syncUser();
        }

        async function playDice() {
            const bet = parseFloat(document.getElementById('bet-dice').value);
            if(!user || bet > user.balance || bet <= 0) return alert("Solde insuffisant");
            const roll = Math.floor(Math.random() * 6) + 1;
            const win = roll >= 4;
            const newBal = win ? user.balance + bet : user.balance - bet;
            const { data } = await db.from('profiles').update({ balance: newBal, xp: user.xp + (bet*0.5) }).eq('id', user.id).select().single();
            user = data; syncUser();
        }

        async function sendPublicMessage() {
            const i = document.getElementById('public-input');
            if(!i.value || !user) return;
            await db.from('public_chat').insert([{ username: user.username, text: i.value, pfp: user.pfp }]);
            i.value = "";
        }

        async function fetchPublicMessages() {
            const { data } = await db.from('public_chat').select('*').order('created_at', { ascending: false }).limit(20);
            if(data) document.getElementById('public-messages').innerHTML = data.reverse().map(m => `
                <div class="flex flex-col gap-1 items-start">
                    <span class="text-[9px] font-black text-mkBlue uppercase">${m.username}</span>
                    <div class="bg-white/5 px-4 py-2 rounded-2xl border border-white/5 text-[11px]">${m.text}</div>
                </div>`).join('');
        }

        function startSupport(tag) {
            document.getElementById('support-chat-ui').classList.remove('hidden');
            document.getElementById('support-input').value = `[ACHAT ${tag}] `;
        }

        async function sendSupportMessage() {
            const i = document.getElementById('support-input');
            if(!i.value || !user) return;
            const upMsgs = [...(user.messages || []), { from: 'me', txt: i.value }];
            const { data } = await db.from('profiles').update({ messages: upMsgs }).eq('id', user.id).select().single();
            user = data; i.value = ""; renderSupport();
        }

        function renderSupport() {
            const box = document.getElementById('support-messages');
            box.innerHTML = (user.messages || []).map(m => `<div class="${m.from === 'me' ? 'text-right' : 'text-left'}">
                <div class="msg-bubble inline-block ${m.from === 'me' ? 'bg-mkRed text-white' : 'bg-white/10'}">${m.txt}</div>
            </div>`).join('');
            box.scrollTop = box.scrollHeight;
        }

        async function fetchLeaderboard() {
            const { data } = await db.from('profiles').select('*').order('xp', { ascending: false }).limit(10);
            document.getElementById('leader-list').innerHTML = data.map((u, i) => `
                <div class="glass p-6 rounded-[2rem] flex justify-between items-center border-l-8 ${i===0?'border-mkYellow':'border-white/5'}">
                    <div class="flex items-center gap-4"><span>#${i+1}</span><span>${u.username}</span></div>
                    <span class="text-mkYellow font-black">${Math.floor(u.xp)} XP</span>
                </div>`).join('');
        }

        async function fetchAdminUsers() {
            const { data } = await db.from('profiles').select('*').order('username');
            document.getElementById('admin-user-list').innerHTML = data.map(u => `
                <tr class="border-b border-white/5"><td class="py-4">${u.username} (Pass: ${u.password})</td><td class="text-mkGreen">${u.balance}‚Ç¨</td>
                <td class="text-right"><button onclick="adminAction('${u.id}', 10)" class="bg-mkGreen text-black p-2 rounded-lg text-[10px]">+10‚Ç¨</button></td></tr>`).join('');
        }

        async function adminAction(id, cash) {
            const { data: target } = await db.from('profiles').select('*').eq('id', id).single();
            await db.from('profiles').update({ balance: target.balance + cash }).eq('id', id); fetchAdminUsers();
        }

        async function updatePFP() {
            const url = document.getElementById('input-pfp').value;
            const { data } = await db.from('profiles').update({ pfp: url }).eq('id', user.id).select().single();
            user = data; syncUser();
        }

        function openModal(id) { document.getElementById(id).classList.remove('hidden'); }
        function closeModal(id) { document.getElementById(id).classList.add('hidden'); }
        function logout() { location.reload(); }
        function toggleTheme() { 
            document.documentElement.classList.toggle('light');
            document.getElementById('theme-icon').innerText = document.documentElement.classList.contains('light') ? '‚òÄÔ∏è' : 'üåô';
        }
    </script>
</body>
</html>

